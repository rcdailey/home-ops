# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/v1/secret.json
---
apiVersion: v1
kind: Secret
metadata:
  name: ${APP}-volsync-secret
type: Opaque
stringData:
  # Kopia repository password - each app gets unique repo
  KOPIA_PASSWORD: ${APP}-volsync-backup-password
  # S3 configuration - using your existing Garage S3
  AWS_ACCESS_KEY_ID: ${S3_ACCESS_KEY_ID}
  AWS_SECRET_ACCESS_KEY: ${S3_SECRET_ACCESS_KEY}
  AWS_DEFAULT_REGION: ${S3_REGION}
  # Kopia S3 specific settings - separate endpoint and bucket
  KOPIA_S3_ENDPOINT: ${S3_ENDPOINT}
  KOPIA_S3_BUCKET: volsync-backups
  KOPIA_S3_PREFIX: ${APP}
  KOPIA_S3_DISABLE_TLS: "true"
  # Repository URL - simplified for Kopia S3 format
  KOPIA_REPOSITORY: s3://volsync-backups/${APP}
