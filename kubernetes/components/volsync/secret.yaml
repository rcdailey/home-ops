# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/v1/secret.json
---
apiVersion: v1
kind: Secret
metadata:
  name: ${APP}-volsync-secret
type: Opaque
stringData:
  # Kopia repository password - MUST BE SAME for all apps sharing repository
  # Uses shared repository pattern: all apps write to single Kopia repository with
  # isolation handled via username@hostname snapshots (e.g., prowlarr@media:/data)
  # See docs/memory-bank/volsync-kopia-s3-prefix-research.md for full context
  KOPIA_PASSWORD: volsync-shared-kopia-password

  # S3 access credentials
  AWS_ACCESS_KEY_ID: ${S3_ACCESS_KEY_ID}
  AWS_SECRET_ACCESS_KEY: ${S3_SECRET_ACCESS_KEY}
  AWS_DEFAULT_REGION: ${S3_REGION}

  # Kopia S3 configuration - shared repository at bucket root
  # All apps share s3://volsync-backups/ - VolSync automatically sets username/hostname
  # for snapshot isolation. Benefits: deduplication, single bucket management.
  KOPIA_REPOSITORY: s3://volsync-backups/
  KOPIA_S3_ENDPOINT: ${S3_ENDPOINT}
  KOPIA_S3_DISABLE_TLS: "true"
