---
# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/secrets.infisical.com/infisicalsecret_v1alpha1.json
apiVersion: secrets.infisical.com/v1alpha1
kind: InfisicalSecret
metadata:
  name: ${APP}-secrets
spec:
  resyncInterval: 60
  hostAPI: http://infisical-main.default:8080/api
  authentication:
    universalAuth:
      secretsScope:
        projectSlug: "home-ops"
        envSlug: "prod"
        secretsPath: "/apps/${NAMESPACE}/${APP}"
        recursive: true
      credentialsRef:
        secretName: "infisical-secrets"
        secretNamespace: "${NAMESPACE}"
  managedSecretReference:
    secretName: ${INFISICAL_SECRET_NAME:=${APP}-secret}
    secretNamespace: ${NAMESPACE}
    creationPolicy: "Orphan"
