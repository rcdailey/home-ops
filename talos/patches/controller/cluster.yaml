cluster:
  allowSchedulingOnControlPlanes: true
  apiServer:
    admissionControl:
      $$patch: delete
    extraArgs:
      # https://kubernetes.io/docs/tasks/extend-kubernetes/configure-aggregation-layer/
      enable-aggregator-routing: true
      # Enable MutatingAdmissionPolicy for VolSync NFS volume injection
      # Requires both feature gate and runtime-config (beta feature in K8s 1.34)
      feature-gates: MutatingAdmissionPolicy=true
      runtime-config: admissionregistration.k8s.io/v1beta1=true
  controllerManager:
    extraArgs:
      bind-address: 0.0.0.0
      # Lower threshold for terminated pod garbage collection (default: 12500)
      # Cleans up Error/Completed pods more frequently to prevent accumulation
      terminated-pod-gc-threshold: "100"
  coreDNS:
    disabled: true
  etcd:
    extraArgs:
      listen-metrics-urls: http://0.0.0.0:2381
      # Enable auto-compaction to prevent excessive database growth and fragmentation
      # periodic mode with 24h retention compacts data older than 24 hours every hour
      # This prevents fragmentation that causes slow commit durations (>250ms threshold)
      auto-compaction-mode: periodic
      auto-compaction-retention: "24h"
    advertisedSubnets:
      - 192.168.1.0/24
  proxy:
    disabled: true
  scheduler:
    extraArgs:
      bind-address: 0.0.0.0
